(function(t){function e(e){for(var a,n,o=e[0],c=e[1],l=e[2],d=0,f=[];d<o.length;d++)n=o[d],Object.prototype.hasOwnProperty.call(i,n)&&i[n]&&f.push(i[n][0]),i[n]=0;for(a in c)Object.prototype.hasOwnProperty.call(c,a)&&(t[a]=c[a]);u&&u(e);while(f.length)f.shift()();return r.push.apply(r,l||[]),s()}function s(){for(var t,e=0;e<r.length;e++){for(var s=r[e],a=!0,o=1;o<s.length;o++){var c=s[o];0!==i[c]&&(a=!1)}a&&(r.splice(e--,1),t=n(n.s=s[0]))}return t}var a={},i={app:0},r=[];function n(e){if(a[e])return a[e].exports;var s=a[e]={i:e,l:!1,exports:{}};return t[e].call(s.exports,s,s.exports,n),s.l=!0,s.exports}n.m=t,n.c=a,n.d=function(t,e,s){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:s})},n.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var s=Object.create(null);if(n.r(s),Object.defineProperty(s,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var a in t)n.d(s,a,function(e){return t[e]}.bind(null,a));return s},n.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="/";var o=window["webpackJsonp"]=window["webpackJsonp"]||[],c=o.push.bind(o);o.push=e,o=o.slice();for(var l=0;l<o.length;l++)e(o[l]);var u=c;r.push([0,"chunk-vendors"]),s()})({0:function(t,e,s){t.exports=s("56d7")},3820:function(t,e,s){"use strict";s("d9ba")},4678:function(t,e,s){var a={"./af":"2bfb","./af.js":"2bfb","./ar":"8e73","./ar-dz":"a356","./ar-dz.js":"a356","./ar-kw":"423e","./ar-kw.js":"423e","./ar-ly":"1cfd","./ar-ly.js":"1cfd","./ar-ma":"0a84","./ar-ma.js":"0a84","./ar-sa":"8230","./ar-sa.js":"8230","./ar-tn":"6d83","./ar-tn.js":"6d83","./ar.js":"8e73","./az":"485c","./az.js":"485c","./be":"1fc1","./be.js":"1fc1","./bg":"84aa","./bg.js":"84aa","./bm":"a7fa","./bm.js":"a7fa","./bn":"9043","./bn-bd":"9686","./bn-bd.js":"9686","./bn.js":"9043","./bo":"d26a","./bo.js":"d26a","./br":"6887","./br.js":"6887","./bs":"2554","./bs.js":"2554","./ca":"d716","./ca.js":"d716","./cs":"3c0d","./cs.js":"3c0d","./cv":"03ec","./cv.js":"03ec","./cy":"9797","./cy.js":"9797","./da":"0f14","./da.js":"0f14","./de":"b469","./de-at":"b3eb","./de-at.js":"b3eb","./de-ch":"bb71","./de-ch.js":"bb71","./de.js":"b469","./dv":"598a","./dv.js":"598a","./el":"8d47","./el.js":"8d47","./en-au":"0e6b","./en-au.js":"0e6b","./en-ca":"3886","./en-ca.js":"3886","./en-gb":"39a6","./en-gb.js":"39a6","./en-ie":"e1d3","./en-ie.js":"e1d3","./en-il":"7333","./en-il.js":"7333","./en-in":"ec2e","./en-in.js":"ec2e","./en-nz":"6f50","./en-nz.js":"6f50","./en-sg":"b7e9","./en-sg.js":"b7e9","./eo":"65db","./eo.js":"65db","./es":"898b","./es-do":"0a3c","./es-do.js":"0a3c","./es-mx":"b5b7","./es-mx.js":"b5b7","./es-us":"55c9","./es-us.js":"55c9","./es.js":"898b","./et":"ec18","./et.js":"ec18","./eu":"0ff2","./eu.js":"0ff2","./fa":"8df4","./fa.js":"8df4","./fi":"81e9","./fi.js":"81e9","./fil":"d69a","./fil.js":"d69a","./fo":"0721","./fo.js":"0721","./fr":"9f26","./fr-ca":"d9f8","./fr-ca.js":"d9f8","./fr-ch":"0e49","./fr-ch.js":"0e49","./fr.js":"9f26","./fy":"7118","./fy.js":"7118","./ga":"5120","./ga.js":"5120","./gd":"f6b4","./gd.js":"f6b4","./gl":"8840","./gl.js":"8840","./gom-deva":"aaf2","./gom-deva.js":"aaf2","./gom-latn":"0caa","./gom-latn.js":"0caa","./gu":"e0c5","./gu.js":"e0c5","./he":"c7aa","./he.js":"c7aa","./hi":"dc4d","./hi.js":"dc4d","./hr":"4ba9","./hr.js":"4ba9","./hu":"5b14","./hu.js":"5b14","./hy-am":"d6b6","./hy-am.js":"d6b6","./id":"5038","./id.js":"5038","./is":"0558","./is.js":"0558","./it":"6e98","./it-ch":"6f12","./it-ch.js":"6f12","./it.js":"6e98","./ja":"079e","./ja.js":"079e","./jv":"b540","./jv.js":"b540","./ka":"201b","./ka.js":"201b","./kk":"6d79","./kk.js":"6d79","./km":"e81d","./km.js":"e81d","./kn":"3e92","./kn.js":"3e92","./ko":"22f8","./ko.js":"22f8","./ku":"2421","./ku.js":"2421","./ky":"9609","./ky.js":"9609","./lb":"440c","./lb.js":"440c","./lo":"b29d","./lo.js":"b29d","./lt":"26f9","./lt.js":"26f9","./lv":"b97c","./lv.js":"b97c","./me":"293c","./me.js":"293c","./mi":"688b","./mi.js":"688b","./mk":"6909","./mk.js":"6909","./ml":"02fb","./ml.js":"02fb","./mn":"958b","./mn.js":"958b","./mr":"39bd","./mr.js":"39bd","./ms":"ebe4","./ms-my":"6403","./ms-my.js":"6403","./ms.js":"ebe4","./mt":"1b45","./mt.js":"1b45","./my":"8689","./my.js":"8689","./nb":"6ce3","./nb.js":"6ce3","./ne":"3a39","./ne.js":"3a39","./nl":"facd","./nl-be":"db29","./nl-be.js":"db29","./nl.js":"facd","./nn":"b84c","./nn.js":"b84c","./oc-lnc":"167b","./oc-lnc.js":"167b","./pa-in":"f3ff","./pa-in.js":"f3ff","./pl":"8d57","./pl.js":"8d57","./pt":"f260","./pt-br":"d2d4","./pt-br.js":"d2d4","./pt.js":"f260","./ro":"972c","./ro.js":"972c","./ru":"957c","./ru.js":"957c","./sd":"6784","./sd.js":"6784","./se":"ffff","./se.js":"ffff","./si":"eda5","./si.js":"eda5","./sk":"7be6","./sk.js":"7be6","./sl":"8155","./sl.js":"8155","./sq":"c8f3","./sq.js":"c8f3","./sr":"cf1e","./sr-cyrl":"13e9","./sr-cyrl.js":"13e9","./sr.js":"cf1e","./ss":"52bd","./ss.js":"52bd","./sv":"5fbd","./sv.js":"5fbd","./sw":"74dc","./sw.js":"74dc","./ta":"3de5","./ta.js":"3de5","./te":"5cbb","./te.js":"5cbb","./tet":"576c","./tet.js":"576c","./tg":"3b1b","./tg.js":"3b1b","./th":"10e8","./th.js":"10e8","./tk":"5aff","./tk.js":"5aff","./tl-ph":"0f38","./tl-ph.js":"0f38","./tlh":"cf75","./tlh.js":"cf75","./tr":"0e81","./tr.js":"0e81","./tzl":"cf51","./tzl.js":"cf51","./tzm":"c109","./tzm-latn":"b53d","./tzm-latn.js":"b53d","./tzm.js":"c109","./ug-cn":"6117","./ug-cn.js":"6117","./uk":"ada2","./uk.js":"ada2","./ur":"5294","./ur.js":"5294","./uz":"2e8c","./uz-latn":"010e","./uz-latn.js":"010e","./uz.js":"2e8c","./vi":"2921","./vi.js":"2921","./x-pseudo":"fd7e","./x-pseudo.js":"fd7e","./yo":"7f33","./yo.js":"7f33","./zh-cn":"5c3a","./zh-cn.js":"5c3a","./zh-hk":"49ab","./zh-hk.js":"49ab","./zh-mo":"3a6c","./zh-mo.js":"3a6c","./zh-tw":"90ea","./zh-tw.js":"90ea"};function i(t){var e=r(t);return s(e)}function r(t){if(!s.o(a,t)){var e=new Error("Cannot find module '"+t+"'");throw e.code="MODULE_NOT_FOUND",e}return a[t]}i.keys=function(){return Object.keys(a)},i.resolve=r,t.exports=i,i.id="4678"},"556c":function(t,e,s){"use strict";s("ca2e")},"56d7":function(t,e,s){"use strict";s.r(e);s("e260"),s("e6cf"),s("cca6"),s("a79d");var a=s("2b0e"),i=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{attrs:{id:"app"},on:{click:t.clickOnLayoutHandler}},[t.isAuth?s("Header"):t._e(),s("router-view")],1)},r=[],n=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("header",{staticClass:"page-header"},[s("div",{staticClass:"page-header__wrapper"},[s("p",{staticClass:"page-header__admin"},[t._v(" Администратор Бизнес Зала "),s("span",{staticClass:"page-header__place"},[t._v("«"+t._s(t.title)+"»")])]),s("OfflineIdicator"),s("Notifications"),s("button",{staticClass:"page-header__button button-alternate",attrs:{disabled:t.isCertificatesPage},on:{click:t.goToCertificates}},[t._v(" Реестр сертификатов ")]),s("button",{staticClass:"page-header__button button-alternate",on:{click:t.logout}},[t._v(" Выйти ")])],1)])},o=[],c=(s("b0c0"),function(){var t=this,e=t.$createElement,s=t._self._c||e;return t.isOffline?s("div",{staticClass:"connection-status"},[t._m(0),s("div",{staticClass:"connection-status__popup"},[s("div",{staticClass:"connection-status__window"},[s("h2",{staticClass:"connection-status__title",class:{"connection-status__title--wide":!t.tryToConnect}},[t._v(" "+t._s(t.tryToConnect?"Отсутствует интернет или связь с сервером":"Мы не смогли установить связь с сервером")+" ")]),t.tryToConnect?s("p",{staticClass:"connection-status__count"},[t._v(" Пытаемся установить соединение "),s("span",{staticClass:"connection-status__time"},[t._v(t._s(t.timeToCall))])]):t._e(),t.tryToConnect?t._e():s("p",{staticClass:"connection-status__text"},[t._v(" Для проверки статуса сертификата позвоните по указанному номеру телефона и назовите номер сертификата — мы активируем его вручную. ")]),t.tryToConnect?t._e():s("p",{staticClass:"connection-status__text"},[t._v(" После восстановления связи запись о гашении сертификата будет размещена в реестре автоматически. ")])])])]):t._e()}),l=[function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("button",{staticClass:"connection-status__toggle-button"},[s("span",{staticClass:"visually-hidden"},[t._v("Соединение отсутствует")])])}],u={data:function(){return{isOffline:!1,timeToCall:30,intervalId:null}},mounted:function(){var t=this.setOnline,e=this.setOffline;window.addEventListener("offline",this.setOffline),window.addEventListener("online",this.setOnline),this.$axios.interceptors.response.use((function(e){return t(),e}),(function(t){return t.code>=500&&t.code<600&&e(),t})),this.intervalId=setInterval(this.decrementTimeToCall,1e3)},beforeDestroy:function(){window.removeEventListener("offline",this.setOffline),window.removeEventListener("online",this.setOnline),clearInterval(this.intervalId),this.timeToCall=30},methods:{setOnline:function(){this.timeToCall=30,this.isOffline=!1},setOffline:function(){this.timeToCall=30,this.isOffline=!0},decrementTimeToCall:function(){this.timeToCall>=0&&(this.timeToCall=this.timeToCall-1)}},computed:{tryToConnect:function(){return this.timeToCall>=0}}},d=u,f=(s("556c"),s("2877")),m=Object(f["a"])(d,c,l,!1,null,"822c1b9c",null),_=m.exports,h=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("button",{staticClass:"notifications",class:{"notifications--is-present":t.isNewNotes,"notifications--list-shown":t.isShownNotesList},attrs:{type:"button"},on:{click:function(e){return e.stopPropagation(),t.toggleNotesList.apply(null,arguments)}}},[s("SvgIcon",{attrs:{name:"bell"}}),s("span",{staticClass:"notifications__count"},[t._v(t._s(t.count))]),t.isShownNotesList?s("NotesList"):t._e(),t.isNewNotes&&!t.isShownNotesList?s("NewNotes"):t._e()],1)},p=[],v=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"notes-list",on:{click:function(t){t.stopPropagation()}}},[s("h3",{staticClass:"notes-list__title"},[t._v("Уведомления")]),s("button",{staticClass:"notes-list__clear",on:{click:t.clearNotes}},[t._v(" Очистить уведомления ")]),s("div",{staticClass:"notes-list__wrapper"},[s("ul",{staticClass:"notes-list__list"},t._l(t.notes,(function(t,e){return s("li",{key:e},[s("Note",{attrs:{note:t}})],1)})),0)])])},g=[],b={computed:{notes:function(){return this.$store.getters["getAllNotes"]}},methods:{clearNotes:function(){this.$store.dispatch("clearAllNotes")}}},C=b,w=Object(f["a"])(C,v,g,!1,null,null,null),y=w.exports,j=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("ul",{staticClass:"notifications__new-list",on:{click:function(t){t.stopPropagation()}}},t._l(t.newNotes,(function(t,e){return s("li",{key:t.id},[s("Note",{staticClass:"note--new",style:"animation-delay: "+100*(e+1)+"ms",attrs:{note:t}})],1)})),0)},x=[],N={mounted:function(){this.$eventBus.$on("click-on-layout",this.clearNewEvents)},computed:{newNotes:function(){return this.$store.getters["getNewNotes"]?this.$store.getters["getNewNotes"]:[]}},methods:{clearNewEvents:function(){this.$store.dispatch("clearNewNotes")}}},k=N,$=Object(f["a"])(k,j,x,!1,null,null,null),O=$.exports,T={data:function(){return{isShownNotesList:!1}},components:{NotesList:y,NewNotes:O},mounted:function(){this.$eventBus.$on("click-on-layout",this.hideNotesList)},computed:{count:function(){var t=this.$store.getters["getAllNotes"].length;return t<1?"":t>99?"99+":t},isNewNotes:function(){return this.$store.getters["getNewNotes"]&&this.$store.getters["getNewNotes"].length>0}},methods:{toggleNotesList:function(){this.$store.dispatch("clearNewNotes"),this.isShownNotesList=!this.isShownNotesList},hideNotesList:function(){this.$store.dispatch("clearNewNotes"),this.isShownNotesList=!1}}},D=T,S=Object(f["a"])(D,h,p,!1,null,null,null),P=S.exports,E={components:{OfflineIdicator:_,Notifications:P},computed:{isCertificatesPage:function(){return"Certificates"===this.$route.name},hallName:function(){return this.$store.getters["getHallName"]},adminName:function(){return this.$store.getters["getHallAdminName"]},title:function(){return this.hallName?this.hallName:this.adminName}},methods:{logout:function(){var t=this;this.$store.dispatch("logout").then((function(){t.$router.push({name:"Auth"}),t.$store.commit("clearHallData")}))},goToCertificates:function(){this.$router.push({name:"Certificates"})},changestatus:function(){this.$axios.post("/certificates-change-status",{id:9,status:"inactive"})}}},R=E,q=Object(f["a"])(R,n,o,!1,null,null,null),I=q.exports,L={components:{Header:I},computed:{isAuth:function(){return this.$store.getters["authenticated"]&&this.$store.getters["token"]}},methods:{clickOnLayoutHandler:function(){this.$eventBus.$emit("click-on-layout")}}},A=L,M=Object(f["a"])(A,i,r,!1,null,null,null),Y=M.exports,H=s("5530"),z=s("8c4f"),B=s("2f62"),F=s("0e44"),U=s("1da1"),G=(s("96cf"),s("bc3a")),V=s.n(G),J={code:null,message:"",status:"",certificate:{},user:{}},Q={state:function(){return J},mutations:{mutateOnSuccess:function(t,e){t.status=e.status,t.message=e.message,t.certificate=e.certificate,t.user=e.user,a["default"].prototype.$eventBus.$emit("certificate-scanned")},mutateOnError:function(t,e){t.certificate={},t.user={},t.status=e.status?e.status:"error",t.code=e.code?e.code:null,t.message=e.message?e.message:"Ошибка",a["default"].prototype.$eventBus.$emit("certificate-scanned")},clearStore:function(t){t.certificate={},t.user={},t.status="",t.code=null,t.message=""}},actions:{sendCode:function(t,e){return Object(U["a"])(regeneratorRuntime.mark((function s(){var a,i,r,n;return regeneratorRuntime.wrap((function(s){while(1)switch(s.prev=s.next){case 0:return i=t.commit,r=t.dispatch,s.next=3,V.a.post("certificates-check",e);case 3:n=s.sent,"success"===(null===n||void 0===n||null===(a=n.data)||void 0===a?void 0:a.status)?(i("mutateOnSuccess",n.data),r("fetchHallData")):i("mutateOnError",n.data?n.data:n.response.data);case 5:case"end":return s.stop()}}),s)})))()}},getters:{getCertificate:function(t){return t.certificate},getCertificateUser:function(t){return t.user},getCertificateMessage:function(t){return t.message},getCertificateStatus:function(t){return t.status},getCertificateCode:function(t){return t.code}}},X={authenticated:!1,token:null,error:null,hallId:null},K={state:function(){return X},mutations:{setAuth:function(t,e){t.authenticated=e.authenticated,t.token=e.token,t.hallId=e.hall_id},setError:function(t,e){t.error=e.error},removeError:function(t){t.error=null},logout:function(t){t.authenticated=!1,t.token="",t.hallId=null}},actions:{authenticate:function(t,e){return Object(U["a"])(regeneratorRuntime.mark((function s(){var i,r,n,o,c,l,u;return regeneratorRuntime.wrap((function(s){while(1)switch(s.prev=s.next){case 0:return i=t.commit,r=t.dispatch,s.prev=1,s.next=4,V.a.post("/login",{name:e.name,password:e.password});case 4:if(n=s.sent,"error"===(null===(o=n)||void 0===o||null===(c=o.data)||void 0===c?void 0:c.status)||"error"===(null===(l=n)||void 0===l?void 0:l.status))for(u in i("setError",{error:n.data}),a["default"].prototype.$echo.connector.channels)a["default"].prototype.$echo.leave(u);else i("setAuth",{authenticated:!0,token:"Bearer "+n.data.token}),V.a.defaults.headers.common["authorization"]="Bearer "+n.data.token,r("fetchHallData");s.next=12;break;case 8:s.prev=8,s.t0=s["catch"](1),console.error(s.t0),i("setError",{error:s.t0.response.data});case 12:case"end":return s.stop()}}),s,null,[[1,8]])})))()},logout:function(t){return Object(U["a"])(regeneratorRuntime.mark((function e(){var s,i,r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return s=t.commit,e.prev=1,e.next=4,V.a.post("logout");case 4:if(i=e.sent,200===i.status)for(r in s("logout"),s("clearAllNotes"),V.a.defaults.headers.common["authorization"]="",a["default"].prototype.$echo.connector.channels)a["default"].prototype.$echo.leave(r);e.next=11;break;case 8:e.prev=8,e.t0=e["catch"](1),console.error(e.t0);case 11:case"end":return e.stop()}}),e,null,[[1,8]])})))()}},getters:{authenticated:function(t){return t.authenticated},error:function(t){return t.error},token:function(t){return t.token}}},W=s("2909"),Z=(s("99af"),s("4de4"),{notes:[],newNotes:[]}),tt={state:function(){return Z},mutations:{setNotes:function(t,e){t.notes=e.notes},setNewNotes:function(t,e){t.newNotes=e.notes},setNote:function(t,e){t.notes=[].concat(Object(W["a"])(t.notes),[e.note])},setNewNote:function(t,e){t.newNotes=[].concat(Object(W["a"])(t.newNotes),[e.note])},removeNewNote:function(t,e){t.newNotes=t.newNotes.filter((function(t){return t.id!==e.note.id}))}},actions:{clearNewNotes:function(t){var e=t.commit,s=[];e("setNewNotes",{notes:s})},clearAllNotes:function(t){var e=t.commit,s=[];e("setNewNotes",{notes:s}),e("setNotes",{notes:s})},addNote:function(t,e){var s=t.commit,a=e.note;s("setNewNote",{note:a}),s("setNote",{note:a})}},getters:{getAllNotes:function(t){return t.notes},getNewNotes:function(t){return t.newNotes}}},et=(s("d3b7"),{data:null}),st={state:function(){return et},mutations:{setHallData:function(t,e){t.data=e.data},clearHallData:function(t){t.data=null}},actions:{fetchHallData:function(t){return Object(U["a"])(regeneratorRuntime.mark((function e(){var s,i,r,n,o;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return s=t.commit,i=t.dispatch,r=t.getters,e.prev=1,e.next=4,a["default"].prototype.$axios.get("/hall");case 4:n=e.sent,o=n.data.data,s("setHallData",{data:o}),a["default"].prototype.$echo.options.auth.headers.Authorization||(a["default"].prototype.$echo.options.auth.headers.Authorization=r["token"]),a["default"].prototype.$echo.connector.channels["private-user-events.".concat(n.data.data.user_id)]||a["default"].prototype.$echo.private("user-events.".concat(n.data.data.user_id)).listen("CertificateScannedEvent",(function(t){t.message._type="scanned",i("addNote",{note:t.message}),"success"===t.message.status?s("mutateOnSuccess",t.message):s("mutateOnError",t.message),i("fetchHallData")})).listen("OrderCreatedEvent",(function(t){var e=t.order,s=e.id;e._type="OrderCreatedEvent",i("addNote",{note:e}),a["default"].prototype.$echo.connector.channels["private-orders.updated.".concat(s)]||a["default"].prototype.$echo.private("orders.updated.".concat(s)).listen("OrderUpdatedEvent",(function(t){var e=t.order;e._type="OrderUpdatedEvent",i("addNote",{note:e}),"completed"!==e.status&&"failed"!==e.status||("completed"===e.status&&Object(U["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,new Promise((function(t){return setTimeout(t,4500)}));case 2:i("fetchHallData");case 3:case"end":return t.stop()}}),t)})))(),a["default"].prototype.$echo.leave("orders.updated.".concat(s)))}))})),e.next=15;break;case 11:e.prev=11,e.t0=e["catch"](1),s("logout"),console.error(e.t0);case 15:case"end":return e.stop()}}),e,null,[[1,11]])})))()},sendExpiredCertificate:function(t,e){return Object(U["a"])(regeneratorRuntime.mark((function s(){var i,r,n;return regeneratorRuntime.wrap((function(s){while(1)switch(s.prev=s.next){case 0:return i=t.commit,s.prev=1,s.next=4,a["default"].prototype.$axios.post("/certificates-expired",{id:e.id});case 4:r=s.sent,n=r.data.hall,i("setHallData",{data:n}),s.next=12;break;case 9:s.prev=9,s.t0=s["catch"](1),console.error(s.t0);case 12:case"end":return s.stop()}}),s,null,[[1,9]])})))()},removeCertificate:function(t,e){return Object(U["a"])(regeneratorRuntime.mark((function s(){var i,r,n;return regeneratorRuntime.wrap((function(s){while(1)switch(s.prev=s.next){case 0:return i=t.commit,s.next=3,a["default"].prototype.$axios.post("/certificates-remove",{id:e.id});case 3:r=s.sent,n=r.data.hall,i("setHallData",{data:n});case 6:case"end":return s.stop()}}),s)})))()}},getters:{getHallData:function(t){return t.data},getHallName:function(t){return t.data&&t.data.name?t.data.name:""},getHallAdminName:function(t){return t.data&&t.data.admin_name?t.data.admin_name:""},getHallCertificates:function(t){return t.data&&t.data.certificates?t.data.certificates:[]}}},at={data:null,hall:null,totalCertificates:0,totalVisits:0},it={state:function(){return at},mutations:{setRegistryData:function(t,e){t.data=e.data.certificates,t.hall=e.data.hall,t.totalCertificates=e.data.certificates.total,t.totalVisits=e.data.hall.certificates_sum_pass_limit}},actions:{fetchRegistryData:function(t){return Object(U["a"])(regeneratorRuntime.mark((function e(){var s,i,r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return s=t.commit,e.prev=1,e.next=4,a["default"].prototype.$axios.get("/hall/certificates");case 4:i=e.sent,r=i.data.data,s("setRegistryData",{data:r}),e.next=12;break;case 9:e.prev=9,e.t0=e["catch"](1),401===e.t0.response.status&&s("logout");case 12:case"end":return e.stop()}}),e,null,[[1,9]])})))()},filterRegistryData:function(t,e){return Object(U["a"])(regeneratorRuntime.mark((function s(){var i,r,n;return regeneratorRuntime.wrap((function(s){while(1)switch(s.prev=s.next){case 0:return i=t.commit,s.prev=1,s.next=4,a["default"].prototype.$axios.get("/hall/certificates"+e);case 4:r=s.sent,n=r.data.data,i("setRegistryData",{data:n}),s.next=13;break;case 9:s.prev=9,s.t0=s["catch"](1),401===s.t0.response.status&&i("logout"),console.error(s.t0);case 13:case"end":return s.stop()}}),s,null,[[1,9]])})))()}},getters:{getRegistryData:function(t){return t.data},getRegistryName:function(t){return t.hall&&t.hall.name?t.hall.name:""},getRegistryPrefix:function(t){return t.hall&&t.hall.prefix?t.hall.prefix.toUpperCase():""},getRegistryAdminName:function(t){return t.hall&&t.hall.admin_name?t.hall.admin_name:""},getRegistryId:function(t){return t.hall&&t.hall.id?t.hall.id:""},getRegistryCertificates:function(t){return t.data&&t.data.data?t.data.data:[]},getTotalCertificates:function(t){return t.totalCertificates},getTotalVisits:function(t){return t.totalVisits}}};a["default"].use(B["a"]);var rt=new B["a"].Store({modules:{certificateStore:Q,authStore:K,notifications:tt,hall:st,registry:it},plugins:[Object(F["a"])({paths:["authStore.authenticated","authStore.token","authStore.hallId"]})]}),nt=function(t){var e=t.next,s=t.store;return s.getters.authenticated?e():e({name:"Auth"})},ot=function(t){var e=t.next,s=t.store,a=t.app;return s.getters.authenticated&&s.getters.token?(a.prototype.$axios.defaults.headers.common["authorization"]=s.getters.token,e({name:"Home"})):e()},ct=function(t){var e=t.next,s=t.store;return s.getters["getHallData"]||s.dispatch("fetchHallData"),e()};function lt(t,e,s){var a=e[s];return a?function(){var i=lt(t,e,s+1);a(Object(H["a"])(Object(H["a"])({},t),{},{next:i}))}:t.next}var ut=lt,dt=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("main",{staticClass:"page-main"},[s("div",{staticClass:"page-main__wrapper"},[s("section",{staticClass:"page-main__section"},[s("h2",{staticClass:"page-main__title"},[t._v("Активация сертификата")]),s("QrScanner"),s("Certificate")],1),s("section",{staticClass:"page-main__section"},[s("h2",{staticClass:"page-main__title"},[t._v("Список гостей")]),s("GuestsList")],1)])])},ft=[],mt=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("form",{staticClass:"qr-scanner",attrs:{action:"#",method:"post",autocomplete:"off"},on:{submit:function(e){return e.preventDefault(),t.submit.apply(null,arguments)}}},[s("div",{staticClass:"qr-scanner__input-wrapper"},[s("input",{directives:[{name:"model",rawName:"v-model",value:t.qr,expression:"qr"}],ref:"input",staticClass:"qr-scanner__input",class:{"qr-scanner__input--applied":t.isCodeApplied,"qr-scanner__input--declined":t.isCodeDeclined},attrs:{type:"text",name:"qr-code",id:"qr-code",placeholder:"Введите код сертификата",required:""},domProps:{value:t.qr},on:{input:function(e){e.target.composing||(t.qr=e.target.value)}}}),s("label",{staticClass:"qr-scanner__placeholder",attrs:{for:"qr-code"}},[t._v("Введите код сертификата")])]),s("p",{staticClass:"qr-scanner__message"},[s("SvgIcon",{attrs:{name:"info","class-name":"qr-scanner__message-icon",width:"17",height:"17"}}),t._v(" Для посещения Бизнес-зала билет не требуется ")],1),s("button",{staticClass:"qr-scanner__submit button",attrs:{type:"submit"}},[t._v("Активировать")])])},_t=[],ht={data:function(){return{qr:""}},beforeMount:function(){this.$eventBus.$on("clear-qr",this.clearQr)},mounted:function(){this.$refs.input.focus()},beforeDestroy:function(){this.$eventBus.$off("clear-qr",this.clearQr)},methods:{submit:function(){this.$store.dispatch("sendCode",{code:this.qr})},clearQr:function(){this.qr=""}},computed:{isCodeDeclined:function(){return"error"===this.$store.getters["getCertificateStatus"]},isCodeApplied:function(){return"success"===this.$store.getters["getCertificateStatus"]}}},pt=ht,vt=Object(f["a"])(pt,mt,_t,!1,null,null,null),gt=vt.exports,bt=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"certificate",class:{"certificate--empty":!t.status}},[t.status?t._e():s("p",{staticClass:"certificate__empty"},[t._v(" Сертификат еще не просканирован ")]),t.error?s("div",{staticClass:"certificate__wrapper certificate__wrapper--error"},[s("h2",{staticClass:"certificate__title certificate__title--mba"},[s("SvgIcon",{attrs:{className:"certificate__icon",name:"red-face",width:"30",height:"30"}}),t._v(t._s(t.title)+" ")],1),s("div",{staticClass:"certificate__controls"},[s("p",{staticClass:"certificate__message certificate__message--absolute",class:{" certificate__message--error":t.description<1}},[t._v(" "+t._s("Вход в бизнес зал запрещен.")+" ")]),s("button",{key:t.timeToClear,staticClass:"certificate__close-button button button--attention",on:{click:t.clearCertificate}},[t._v(" Закрыть ("+t._s(t.timeToClear)+") ")])])]):t._e(),t.isNotExist?s("div",{staticClass:"certificate__wrapper certificate__wrapper--error"},[s("h2",{staticClass:"certificate__title certificate__title--mba"},[s("SvgIcon",{attrs:{className:"certificate__icon",name:"red-face",width:"30",height:"30"}}),t._v(t._s(t.title)+" ")],1),s("div",{staticClass:"certificate__controls"},[s("p",{staticClass:"certificate__message certificate__message--absolute",class:{" certificate__message--error":t.description<1}},[t._v(" "+t._s("Вход в бизнес зал запрещен.")+" ")]),s("button",{key:t.timeToClear,staticClass:"certificate__close-button button button--attention",on:{click:t.clearCertificate}},[t._v(" Закрыть ("+t._s(t.timeToClear)+") ")])])]):t._e(),t.hasBeenActivated?s("div",{staticClass:"certificate__wrapper certificate__wrapper--error"},[s("h2",{staticClass:"certificate__title certificate__title--mba"},[s("SvgIcon",{attrs:{className:"certificate__icon",name:"red-face",width:"30",height:"30"}}),t._v(t._s(t.title)+" ")],1),s("div",{staticClass:"certificate__controls"},[s("p",{staticClass:"certificate__message",class:{" certificate__message--error":t.isMessageError}},[t._v(" "+t._s("Вход в бизнес зал запрещен.")+" ")]),s("button",{key:t.timeToClear,staticClass:"certificate__close-button button button--attention",on:{click:t.clearCertificate}},[t._v(" Закрыть ("+t._s(t.timeToClear)+") ")])])]):t._e(),"success"===t.status?s("div",{staticClass:"certificate__wrapper certificate__wrapper--success"},[s("h2",{staticClass:"certificate__title"},[s("SvgIcon",{attrs:{className:"certificate__icon",name:"green-face",width:"30",height:"30"}}),t._v(t._s(t.title)+" ")],1),s("dl",{staticClass:"certificate__paragraph certificate__paragraph--before-text"},[s("dt",{staticClass:"certificate__term"},[t._v(t._s(t.term))]),s("dd",{staticClass:"certificate__description certificate__description--plain"},[t._v(" "+t._s(t.certificate.pass_limit)+" ")])]),s("p",{staticClass:"certificate__text"},[t._v(" Посещение Бизнес-зала разрешено. Для посещения Бизнес-зала билет не требуется. ")]),s("div",{staticClass:"certificate__controls"},[s("TimerToggler",{attrs:{timer:t.timer,"toggle-timer":t.toggleTimer}}),s("button",{key:t.timeToClear,staticClass:"certificate__close-button button button--accept",on:{click:t.clearCertificate}},[t._v(" Закрыть ("+t._s(t.timeToClear)+") ")])],1)]):t._e()])},Ct=[],wt=(s("a9e3"),s("a4d3"),s("e01a"),function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("label",{staticClass:"certificate__label",class:{"certificate__label--active":t.timer,"guest__timer-toggler":t.isGuest},attrs:{for:"timer-checkbox"}},[t._v("Таймер "),s("input",{attrs:{type:"checkbox",name:"timer",id:"timer-checkbox"},domProps:{checked:t.timer},on:{change:t.toggleTimer}})])}),yt=[],jt={props:{isGuest:{type:Boolean,default:!0},timer:{type:Boolean,default:!0},toggleTimer:{type:Function,default:function(){}}}},xt=jt,Nt=Object(f["a"])(xt,wt,yt,!1,null,null,null),kt=Nt.exports,$t={components:{TimerToggler:kt},data:function(){return{term:"Количество гостей:",description:0,message:"Посещение Бизнес-зала разрешено. Для посещения Бизнес-зала билет не требуется.",timeToClear:5,intervalIndex:null,timer:!0}},mounted:function(){var t=this;this.$eventBus.$on("certificate-scanned",(function(){t.intervalIndex=setInterval(t.decrementTimeToCLear,1e3)}))},beforeDestroy:function(){this.intervalIndex&&(clearInterval(this.intervalIndex),this.timeToClear=5)},computed:{error:function(){return"error"===this.status.toLowerCase()&&!this.code},hasBeenActivated:function(){return"error"===this.status.toLowerCase()&&1003===Number(this.code)},isNotExist:function(){return"error"===this.status.toLowerCase()&&1001===Number(this.code)},certificate:function(){return this.$store.getters["getCertificate"]},isMessageError:function(){return!this.isDescriptionError&&this.description<1},isDescriptionError:function(){return"number"!==typeof this.description},code:function(){return this.$store.getters["getCertificateCode"]},status:function(){return this.$store.getters["getCertificateStatus"]},title:function(){return this.$store.getters["getCertificateMessage"]}},methods:{decrementTimeToCLear:function(){this.timeToClear>0?this.timeToClear=this.timeToClear-1:this.clearCertificate()},toggleTimer:function(){var t=this;this.timer=!1,this.$store.dispatch("removeCertificate",{id:this.certificate.id}).catch((function(){t.timer=!0}))},getDescription:function(t){return t<100?t:"99+"},clearCertificate:function(){this.$store.commit("clearStore"),this.$eventBus.$emit("clear-qr"),clearInterval(this.intervalIndex),this.timeToClear=5}}},Ot=$t,Tt=Object(f["a"])(Ot,bt,Ct,!1,null,null,null),Dt=Tt.exports,St=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"guests"},[t.isEpty?t._e():s("div",{staticClass:"guests__header"},[s("span",{staticClass:"guests__header-cell guests__header-cell--number"},[t._v("№ п.п.")]),s("span",{staticClass:"guests__header-cell guests__header-cell--table"},[t._v("№ столика")]),s("span",{staticClass:"guests__header-cell guests__header-cell--table"},[t._v("№ серт.")]),s("span",{staticClass:"guests__header-cell guests__header-cell--guests-count"},[t._v("Кол-во гостей")]),s("span",{staticClass:"guests__header-cell guests__header-cell--timer"},[t._v("Таймер")])]),s("div",{staticClass:"guests__list-wrapper"},[s("ul",{staticClass:"guests__list",class:{"guests__list--empty":t.isEpty}},[t.isEpty?s("li",{staticClass:"guests__item guest__item--empty"},[t._v(" В вашем зале пока нет гостей ")]):t._l(t.guests,(function(t){return s("li",{key:t.id,staticClass:"guests__item"},[s("Guest",{attrs:{data:t}})],1)}))],2)])])},Pt=[],Et={computed:{isEpty:function(){return this.guests.length<1},guests:function(){return this.$store.getters["getHallCertificates"]}}},Rt=Et,qt=Object(f["a"])(Rt,St,Pt,!1,null,null,null),It=qt.exports,Lt={name:"Home",components:{QrScanner:gt,Certificate:Dt,GuestsList:It}},At=Lt,Mt=Object(f["a"])(At,dt,ft,!1,null,null,null),Yt=Mt.exports,Ht=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("main",{staticClass:"page-main"},[s("router-link",{staticClass:"logo",attrs:{to:"/"}},[s("img",{attrs:{src:"/img/logo.png",alt:"Golden Key logo",width:"200",height:"50"}})]),s("AuthForm")],1)},zt=[],Bt=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("form",{staticClass:"auth-form",attrs:{method:"post"},on:{submit:function(e){return e.preventDefault(),t.submitForm.apply(null,arguments)}}},[s("h1",{staticClass:"auth-form__title"},[t._v("Добро пожаловать")]),s("legend",{staticClass:"auth-form__legend"},[t._v(" Чтобы войти, введите логин и пароль ")]),s("label",{staticClass:"auth-form__label"},[s("input",{directives:[{name:"model",rawName:"v-model",value:t.login,expression:"login"}],staticClass:"auth-form__input",class:{"auth-form__input--invalid":t.error},attrs:{type:"text",name:"login",id:"login",placeholder:"Введите логин",required:""},domProps:{value:t.login},on:{input:function(e){e.target.composing||(t.login=e.target.value)}}})]),s("label",{staticClass:"auth-form__label"},["checkbox"===(t.isPassShown?"text":"password")?s("input",{directives:[{name:"model",rawName:"v-model",value:t.password,expression:"password"}],staticClass:"auth-form__input",class:{"auth-form__input--invalid":t.error},attrs:{name:"password",id:"password",placeholder:"Введите пароль",required:"",type:"checkbox"},domProps:{checked:Array.isArray(t.password)?t._i(t.password,null)>-1:t.password},on:{change:function(e){var s=t.password,a=e.target,i=!!a.checked;if(Array.isArray(s)){var r=null,n=t._i(s,r);a.checked?n<0&&(t.password=s.concat([r])):n>-1&&(t.password=s.slice(0,n).concat(s.slice(n+1)))}else t.password=i}}}):"radio"===(t.isPassShown?"text":"password")?s("input",{directives:[{name:"model",rawName:"v-model",value:t.password,expression:"password"}],staticClass:"auth-form__input",class:{"auth-form__input--invalid":t.error},attrs:{name:"password",id:"password",placeholder:"Введите пароль",required:"",type:"radio"},domProps:{checked:t._q(t.password,null)},on:{change:function(e){t.password=null}}}):s("input",{directives:[{name:"model",rawName:"v-model",value:t.password,expression:"password"}],staticClass:"auth-form__input",class:{"auth-form__input--invalid":t.error},attrs:{name:"password",id:"password",placeholder:"Введите пароль",required:"",type:t.isPassShown?"text":"password"},domProps:{value:t.password},on:{input:function(e){e.target.composing||(t.password=e.target.value)}}}),s("button",{staticClass:"auth-form__show-password",attrs:{type:"button"},on:{click:t.togglePass}},[s("span",{staticClass:"visually-hidden"},[t._v("Показать пароль")]),s("SvgIcon",{attrs:{name:t.isPassShown?"close":"open",className:"auth-form__icon"}})],1),s("button",{staticClass:"auth-form__forgot-password",attrs:{type:"button"}},[t._v(" Забыли пароль? ")]),t.error?s("p",{staticClass:"auth-form__error-text"},[t._v(t._s(t.error.message))]):t._e()]),s("button",{staticClass:"auth-form__submit button",attrs:{type:"submit"},on:{submit:function(e){return e.preventDefault(),t.submitForm.apply(null,arguments)}}},[t._v(" Войти ")])])},Ft=[],Ut={data:function(){return{login:"",password:"",isPassShown:!1}},computed:{error:function(){return this.$store.getters["error"]}},methods:{togglePass:function(){this.isPassShown=!this.isPassShown},submitForm:function(){var t=this;this.$store.dispatch("authenticate",{name:this.login,password:this.password}).then((function(){return t.$router.push({name:"Home"})}),(function(t){console.log(t)}))}}},Gt=Ut,Vt=Object(f["a"])(Gt,Bt,Ft,!1,null,null,null),Jt=Vt.exports,Qt={name:"Auth",components:{AuthForm:Jt}},Xt=Qt,Kt=Object(f["a"])(Xt,Ht,zt,!1,null,null,null),Wt=Kt.exports,Zt=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("main",{staticClass:"page-main"},[s("div",{staticClass:"page-main__wrapper"},[s("section",{staticClass:"page-main__section page-main__section--mw100"},[s("div",{staticClass:"page-main__flex-row"},[s("button",{staticClass:"page-main__back-button button-alternate",on:{click:t.toMain}},[s("SvgIcon",{attrs:{name:"arrow",className:"page-main__icon-arrow"}}),t._v(" Назад на главную ")],1),s("h1",{staticClass:"page-main__title page-main__title--m0"},[t._v(" Реестр сертификатов ")]),s("p",{staticClass:"page-main__hall"},[t._v(" Бизнес Зал «"+t._s(t.title)+"»"),s("span",{staticClass:"page-main__hall-code"},[t._v("Код Бизнес-зала: "+t._s(t.hallPrefix))])])]),s("dl",{staticClass:"amount-list"},[s("div",{staticClass:"amount-list__item"},[s("dt",{staticClass:"amount-list__term"},[t._v("Количество сертификатов")]),s("dd",{staticClass:"amount-list__description"},[t._v(t._s(t.totalCertificates))])]),s("div",{staticClass:"amount-list__item"},[s("dt",{staticClass:"amount-list__term"},[t._v("Количество посещений")]),s("dd",{staticClass:"amount-list__description"},[t._v(t._s(t.totalVisits))])])]),s("div",{staticClass:"page-main__flex-row"},[s("h2",{staticClass:"page-main__title"},[t._v("Сертификаты")]),s("ul",{staticClass:"buttons-list"},[s("li",{staticClass:"buttons-list__item"},[s("button",{staticClass:"buttons-list__button",on:{click:t.downloadStatistics}},[s("SvgIcon",{attrs:{name:"download",width:"16",height:"16"}}),t._v(" Сохранить ")],1)]),s("li",{staticClass:"buttons-list__item"},[s("ShareNetwork",{staticClass:"buttons-list__button",attrs:{network:"email"}},[s("SvgIcon",{attrs:{name:"send",width:"16",height:"16"}}),t._v(" Отправить ")],1)],1),s("li",{staticClass:"buttons-list__item"},[s("button",{staticClass:"buttons-list__button",attrs:{disabled:""}},[s("SvgIcon",{attrs:{name:"xlsx",width:"16",height:"16"}}),t._v(" Печатать (.xlsx) ")],1)])])]),s("Filters"),s("CertificatesList")],1)])])},te=[],ee=(s("3ca3"),s("ddb0"),s("2b3d"),s("9861"),s("ac1f"),s("841c"),s("c19f"),s("5cc6"),s("9a8c"),s("a975"),s("735e"),s("c1ac"),s("d139"),s("3a7b"),s("d5d6"),s("82f8"),s("e91f"),s("60bd"),s("5f96"),s("3280"),s("3fcc"),s("ca91"),s("25a1"),s("cd26"),s("3c5d"),s("2954"),s("649e"),s("219c"),s("170b"),s("b39a"),s("72f7"),function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"filters"},[s("input",{directives:[{name:"model",rawName:"v-model",value:t.search,expression:"search"}],staticClass:"filters__search",attrs:{type:"text",name:"search",placeholder:"Поиск по номеру сертификата, ФИО именного сертификата"},domProps:{value:t.search},on:{input:function(e){e.target.composing||(t.search=e.target.value)}}}),s("div",{staticClass:"filters__controls"},[s("h3",{staticClass:"filters__subtitle"},[t._v("Период")]),s("ul",{staticClass:"filters__list"},[s("li",{staticClass:"filters__item"},[s("input",{directives:[{name:"model",rawName:"v-model",value:t.periods,expression:"periods"}],attrs:{type:"radio",name:"period",id:"yesterday-filter",value:"yesterday-filter"},domProps:{checked:t._q(t.periods,"yesterday-filter")},on:{change:function(e){t.periods="yesterday-filter"}}}),s("label",{staticClass:"filters__label",attrs:{for:"yesterday-filter"}},[t._v("Вчера")])]),s("li",{staticClass:"filters__item"},[s("input",{directives:[{name:"model",rawName:"v-model",value:t.periods,expression:"periods"}],attrs:{type:"radio",name:"period",id:"today-filter",value:"today-filter",checked:""},domProps:{checked:t._q(t.periods,"today-filter")},on:{change:function(e){t.periods="today-filter"}}}),s("label",{staticClass:"filters__label",attrs:{for:"today-filter"}},[t._v("Сегодня")])]),s("li",{staticClass:"filters__item"},[s("input",{directives:[{name:"model",rawName:"v-model",value:t.periods,expression:"periods"}],attrs:{type:"radio",name:"period",id:"month-filter",value:"month-filter"},domProps:{checked:t._q(t.periods,"month-filter")},on:{change:function(e){t.periods="month-filter"}}}),s("label",{staticClass:"filters__label",attrs:{for:"month-filter"}},[t._v("Месяц")])]),s("li",{staticClass:"filters__item"},[s("input",{directives:[{name:"model",rawName:"v-model",value:t.periods,expression:"periods"}],attrs:{type:"radio",name:"period",id:"year-filter",value:"year-filter"},domProps:{checked:t._q(t.periods,"year-filter")},on:{change:function(e){t.periods="year-filter"}}}),s("label",{staticClass:"filters__label",attrs:{for:"year-filter"}},[t._v("Год")])]),s("li",{staticClass:"filters__item"},[t._v(" от "),s("DatePicker",{staticClass:"filters__date-picker",attrs:{mode:"date"},scopedSlots:t._u([{key:"default",fn:function(e){var a=e.inputValue,i=e.inputEvents;return[s("input",t._g({staticClass:"filters__date-input",attrs:{placeholder:"дд.мм.гггг"},domProps:{value:a}},i))]}}]),model:{value:t.timeFrom,callback:function(e){t.timeFrom=e},expression:"timeFrom"}})],1),s("li",{staticClass:"filters__item"},[t._v(" до "),s("DatePicker",{staticClass:"filters__date-picker",attrs:{mode:"date"},scopedSlots:t._u([{key:"default",fn:function(e){var a=e.inputValue,i=e.inputEvents;return[s("input",t._g({staticClass:"filters__date-input",attrs:{placeholder:"дд.мм.гггг"},domProps:{value:a}},i))]}}]),model:{value:t.timeTo,callback:function(e){t.timeTo=e},expression:"timeTo"}})],1)])]),s("div",{staticClass:"filters__controls"},[s("h3",{staticClass:"filters__subtitle"},[t._v("Статус")]),s("ul",{staticClass:"filters__list"},[s("li",{staticClass:"filters__item"},[s("input",{directives:[{name:"model",rawName:"v-model",value:t.status,expression:"status"}],attrs:{value:"all",type:"radio",name:"status",id:"all-filter"},domProps:{checked:t._q(t.status,"all")},on:{change:function(e){t.status="all"}}}),s("label",{staticClass:"filters__label",attrs:{for:"all-filter"}},[t._v("Все")])]),s("li",{staticClass:"filters__item"},[s("input",{directives:[{name:"model",rawName:"v-model",value:t.status,expression:"status"}],attrs:{value:"active",type:"radio",name:"status",id:"active-filter",checked:""},domProps:{checked:t._q(t.status,"active")},on:{change:function(e){t.status="active"}}}),s("label",{staticClass:"filters__label",attrs:{for:"active-filter"}},[t._v("Активированные")])]),s("li",{staticClass:"filters__item"},[s("input",{directives:[{name:"model",rawName:"v-model",value:t.status,expression:"status"}],attrs:{type:"radio",value:"inactive",name:"status",id:"inactive-filter"},domProps:{checked:t._q(t.status,"inactive")},on:{change:function(e){t.status="inactive"}}}),s("label",{staticClass:"filters__label",attrs:{for:"inactive-filter"}},[t._v("Не активированые")])]),s("li",{staticClass:"filters__item"},[s("input",{directives:[{name:"model",rawName:"v-model",value:t.status,expression:"status"}],attrs:{type:"radio",value:"left",name:"status",id:"left-filter"},domProps:{checked:t._q(t.status,"left")},on:{change:function(e){t.status="left"}}}),s("label",{staticClass:"filters__label",attrs:{for:"left-filter"}},[t._v("Покинул")])]),s("li",{staticClass:"filters__item"},[s("input",{directives:[{name:"model",rawName:"v-model",value:t.status,expression:"status"}],attrs:{type:"radio",value:"expired",name:"status",id:"expired-filter"},domProps:{checked:t._q(t.status,"expired")},on:{change:function(e){t.status="expired"}}}),s("label",{staticClass:"filters__label",attrs:{for:"expired-filter"}},[t._v("Истек")])])])])])}),se=[],ae={data:function(){return{timeFrom:null,timeTo:null,period:null,status:"active",periods:"today-filter",search:""}},mounted:function(){this.setPeriod()},watch:{timeFrom:function(t){(t||this.timeFrom||this.timeTo)&&(this.periods=""),this.setPeriod()},timeTo:function(t){(t||this.timeFrom||this.timeTo)&&(this.periods=""),this.setPeriod()},periods:function(t){t&&(this.timeFrom=null,this.timeTo=null),this.setPeriod()},status:function(){this.setPeriod()},search:function(){this.setPeriod()}},methods:{setPeriod:function(){var t="?";if(this.periods)switch(this.periods){case"yesterday-filter":var e=this.$moment(new Date).add(-1,"days").format("DD-MM-YYYY");t=t+"date_from="+e+"&date_to="+e;break;case"today-filter":var s=this.$moment(new Date).format("DD-MM-YYYY");t=t+"date_from="+s+"&date_to="+s;break;case"month-filter":var a=this.$moment(new Date).startOf("month").format("DD-MM-YYYY"),i=this.$moment(new Date).endOf("month").format("DD-MM-YYYY");t=t+"date_from="+a+"&date_to="+i;break;case"year-filter":var r=this.$moment(new Date).startOf("year").format("DD-MM-YYYY"),n=this.$moment(new Date).endOf("year").format("DD-MM-YYYY");t=t+"date_from="+r+"&date_to="+n;break}this.timeFrom&&(t=t+"date_from="+this.$moment(this.timeFrom).format("DD-MM-YYYY")),this.timeTo&&(t=t+"&date_to="+this.$moment(this.timeTo).format("DD-MM-YYYY")),"all"!==this.status&&(t=t+"&status="+this.status),this.search&&(t+="&search="+this.search),this.$eventBus.$emit("set-filters",{query:t}),this.$store.dispatch("filterRegistryData",t)}}},ie=ae,re=Object(f["a"])(ie,ee,se,!1,null,null,null),ne=re.exports,oe=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("section",{staticClass:"certificates-list"},[s("div",{staticClass:"certificates-list__table"},[t._m(0),s("ul",{staticClass:"certificates-list__list"},t._l(t.certificates,(function(e){return s("li",{key:e.id,staticClass:"certificates-list__item"},[s("p",{staticClass:"certificates-list__cell certificates-list__cell--hall-code"},[e.halls?[t._v(" "+t._s(e.halls.prefix.toUpperCase())+" ")]:t._e()],2),s("p",{staticClass:"certificates-list__cell certificates-list__cell--hall-name"},[t._v(" "+t._s(t.hallName)+" ")]),s("p",{staticClass:"\n          certificates-list__cell certificates-list__cell--certificate-code\n        "},[t._v(" "+t._s(e.id?e.id:"")+" ")]),s("p",{staticClass:"certificates-list__cell certificates-list__cell--name"},[e.user_name?[t._v(" "+t._s(t.formatUserName(e.user_name))+" ")]:[t._v(" Без имени ")]],2),s("p",{staticClass:"certificates-list__cell certificates-list__cell--date"},[t._v(" "+t._s(e.start_time?t.$moment(e.start_time).format("DD.MM.yyyy"):"")+" ")]),s("p",{staticClass:"certificates-list__cell certificates-list__cell--time"},[t._v(" "+t._s(e.start_time?t.$moment(e.start_time).format("HH:mm"):"")+" ")]),s("p",{staticClass:"\n          certificates-list__cell\n          certificates-list__cell--status\n        ",class:{"certificates-list__cell--success":"active"===e.status,"certificates-list__cell--inactive":"inactive"===e.status,"certificates-list__cell--error":["left","expired"].includes(e.status)}},[t._v(" "+t._s(t.getStatusMsg(e.status))+" ")])])})),0),s("div",{staticClass:"certificates-list__controls"},[s("button",{staticClass:"certificates-list__button button"},[t._v("Загрузить еще")]),s("Pagination",{attrs:{"hall-data":t.hallData,"data-callback":t.paginate}})],1)])])},ce=[function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"certificates-list__head"},[s("p",{staticClass:"\n        certificates-list__head-title\n        certificates-list__head-title--hall-code\n      "},[t._v(" Код "),s("br"),t._v(" Бизнес-зала ")]),s("p",{staticClass:"\n        certificates-list__head-title\n        certificates-list__head-title--hall-name\n      "},[t._v(" Наименование Бизнес-зала ")]),s("p",{staticClass:"\n        certificates-list__head-title\n        certificates-list__head-title--certificate-code\n      "},[t._v(" Номер сертификата ")]),s("p",{staticClass:"\n        certificates-list__head-title certificates-list__head-title--name\n      "},[t._v(" ФИО ")]),s("p",{staticClass:"\n        certificates-list__head-title certificates-list__head-title--date\n      "},[t._v(" Дата ")]),s("p",{staticClass:"\n        certificates-list__head-title certificates-list__head-title--time\n      "},[t._v(" Время ")]),s("p",{staticClass:"\n        certificates-list__head-title\n        certificates-list__head-title--status\n        certificates-list__head-title--error\n        certificates-list__head-title--success\n      "},[t._v(" Статус сертификата ")])])}],le=s("53ca"),ue=(s("a15b"),function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("section",{staticClass:"pagination"},[t.hprevPage?s("a",{staticClass:"pagination__prev-btn",attrs:{href:t.hallData.prev_page_url},on:{click:function(e){return e.preventDefault(),t.getPageData(t.prevPage)}}},[t._v("Назад")]):t._e(),s("ul",{staticClass:"pagination__list"},t._l(t.getPagination,(function(e,a){return s("li",{key:a,staticClass:"pagination__item",class:{"pagination__item--current":e.active,"pagination__item--dots":!e.url}},[s("a",{staticClass:"pagination__link",attrs:{href:e.url,"data-page":e},on:{click:function(s){return s.preventDefault(),t.getPageData(e.url)}}},[t._v(t._s(e.label))])])})),0),t.nextPage?s("a",{staticClass:"pagination__more-btn",attrs:{href:t.nextPage},on:{click:function(e){return e.preventDefault(),t.getPageData(t.nextPage)}}},[t._v("Вперед")]):t._e()])}),de=[],fe=[{},{active:!0,label:"1",url:"12312312"},{active:!1,label:"2",url:"12312312"},{}],me={data:function(){return{}},props:{hallData:{type:Object,default:function(){return{links:fe,next_page_url:"123123123",prev_page_url:"123123123"}}},dataCallback:{type:Function,default:function(){}}},computed:{prevPage:function(){return this.hallData&&this.hallData.prev_page_url?this.hallData.prev_page_url:""},nextPage:function(){return this.hallData&&this.hallData.next_page_url?this.hallData.next_page_url:""},getPagination:function(){var t=[];return this.hallData&&this.hallData.links&&(t=Object(W["a"])(this.hallData.links),t.shift(),t.pop()),t}},methods:{getPageData:function(t){var e=this;t&&this.$axios.get(t).then((function(t){e.dataCallback(t.data)}))}}},_e=me,he=Object(f["a"])(_e,ue,de,!1,null,null,null),pe=he.exports,ve={components:{Pagination:pe},computed:{certificates:function(){return this.$store.getters["getRegistryCertificates"]},hallData:function(){return this.$store.getters["getRegistryData"]},hallName:function(){return this.$store.getters["getRegistryName"]}},methods:{paginate:function(t){var e=t.data;this.$store.commit("setRegistryData",{data:e})},getStatusMsg:function(t){switch(t){case"inactive":return"Не активирован";case"active":return"Активирован";case"expired":return"Истёк срок";case"left":return"Покинул зал"}},formatUserName:function(t){return this.isJson(t)&&(t=JSON.parse(t),t=t.join(", ")),t},isJson:function(t){t="string"!==typeof t?JSON.stringify(t):t;try{t=JSON.parse(t)}catch(e){return!1}return"object"===Object(le["a"])(t)&&null!==t}}},ge=ve,be=Object(f["a"])(ge,oe,ce,!1,null,null,null),Ce=be.exports,we={name:"Certificates",components:{Filters:ne,CertificatesList:Ce},data:function(){return{filters:""}},beforeMount:function(){this.$eventBus.$on("set-filters",this.setFilterHandler)},methods:{downloadStatistics:function(){var t=this;this.$axios.get("/save-certificates"+this.filters,{responseType:"blob"}).then((function(e){var s="gk-".concat(t.hallPrefix.toLowerCase()).concat(t.$moment().format("DDMMYYYY"),".xlsx"),a=window.URL.createObjectURL(new Blob([e.data])),i=document.createElement("a");i.href=a,i.setAttribute("download",s),i.click()}))},setFilterHandler:function(t){var e=t.query;this.filters=e||location.search},s2ab:function(t){for(var e=new ArrayBuffer(t.length),s=new Uint8Array(e),a=0;a<t.length;a++)s[a]=255&t.charCodeAt(a);return e},toMain:function(){this.$router.push({name:"Home"})}},computed:{certificates:function(){return this.$store.getters["getRegistryCertificates"]},title:function(){return this.hallName?this.hallName:this.hallAdminName},hallName:function(){return this.$store.getters["getRegistryName"]},hallPrefix:function(){return this.$store.getters["getRegistryPrefix"]},hallAdminName:function(){return this.$store.getters["getRegistryAdminName"]},hallId:function(){return this.$store.getters["getRegistryId"]},totalCertificates:function(){return this.$store.getters["getTotalCertificates"]},totalVisits:function(){return this.$store.getters["getTotalVisits"]}}},ye=we,je=(s("3820"),Object(f["a"])(ye,Zt,te,!1,null,"6c0fb8d5",null)),xe=je.exports;a["default"].use(z["a"]);var Ne=[{path:"/admin/arm/",name:"Home",component:Yt,meta:{middleware:[ct,ot,nt]}},{path:"/admin/arm/certificates",name:"Certificates",component:xe,meta:{middleware:[ot,ct,nt]}},{path:"/admin/arm/auth",name:"Auth",component:Wt,meta:{middleware:[nt,ot,ct]}},{path:"*",redirect:"/admin/arm/"}],ke=new z["a"]({mode:"history",base:"/",routes:Ne});ke.beforeEach((function(t,e,s){if(!t.meta.middleware)return s();var i=t.meta.middleware,r=a["default"],n={to:t,from:e,next:s,store:rt,app:r};return i[0](Object(H["a"])(Object(H["a"])({},n),{},{next:ut(n,i,1)}))}));var $e=ke,Oe=(s("b72f"),function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("svg",{class:t.className,attrs:{width:t.width,height:t.height}},[s("use",{attrs:{"xlink:href":"/img/sprite.svg#"+t.name}})])}),Te=[],De={props:{className:{type:String,default:""},name:{type:String,default:""},width:{type:[String,Number],default:"24"},height:{type:[String,Number],default:"24"}}},Se=De,Pe=Object(f["a"])(Se,Oe,Te,!1,null,null,null),Ee=Pe.exports,Re=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"guest__timer"},[t._v(" "+t._s(t.timeLeftString)+" ")])},qe=[],Ie={props:{timer:{type:Boolean,default:!0},timeTo:{type:String,default:""},timeLeftString:{type:String,default:"00:00:00"}}},Le=Ie,Ae=Object(f["a"])(Le,Re,qe,!1,null,null,null),Me=Ae.exports,Ye=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("details",{staticClass:"guest",class:{"guest--soon":t.isSoonOver||"expired"===t.data.status},on:{toggle:t.changeGuest}},[s("summary",[s("span",{staticClass:"guest__queue-number"},[t._v(t._s(t.data.queue_id||""))]),s("span",{staticClass:"guest__table"},[t._v(t._s(t.data.table_number?t.data.table_number:t.localTable))]),s("span",{staticClass:"guest__cert"},[t._v(t._s(t.data.id?t.data.id:""))]),s("span",{staticClass:"guest__guests"},[t._v(t._s(t.data.pass_limit))]),s("Timer",{class:{"guest__timer--over-soon":t.isSoonOver||"expired"===t.data.status},attrs:{"time-to":t.data.start_time,"time-left-string":t.timeLeftString}})],1),s("div",{staticClass:"guest__wrapper"},[t.data.table?s("p",{staticClass:"guest__queue-number guest__queue-number--inside"},[t._v(" №гостя: "),s("span",{staticClass:"guest__order"},[t._v(t._s(t.data.table))])]):t._e(),t.data.bank?s("p",{staticClass:"guest__bank"},[t._v("Оплачено с помощью Тинькофф")]):t._e()]),s("div",{staticClass:"guest__wrapper"},[s("input",{directives:[{name:"model",rawName:"v-model",value:t.localTable,expression:"localTable"}],staticClass:"guest__input guest__input--table",attrs:{type:"text",name:"table",placeholder:"№ столика"},domProps:{value:t.localTable},on:{input:function(e){e.target.composing||(t.localTable=e.target.value)}}}),s("textarea",{directives:[{name:"model",rawName:"v-model",value:t.description,expression:"description"}],staticClass:"guest__input",attrs:{name:"description",cols:"30",rows:"2",placeholder:"Здесь вы можете указать комментарии для идентификации гостя"},domProps:{value:t.description},on:{input:function(e){e.target.composing||(t.description=e.target.value)}}})]),s("div",{staticClass:"guest__wrapper"},[s("button",{staticClass:"button guest__cancel-button",on:{click:t.removeCertificate}},[t._v(" Завершить пребывание ")]),s("TimerToggler",{attrs:{toggleTimer:t.toggleTimer,timer:t.timer,"is-guest":!0}})],1)])},He=[],ze={components:{TimerToggler:kt},props:{data:{type:Object,default:function(){return{}}}},data:function(){return{description:"",timeLeftString:"",intervalId:null,isSoonOver:!1,timer:!0,willSendNote:!0,localTable:""}},mounted:function(){this.data.description&&(this.description=this.data.description),this.data.table&&(this.localTable=this.data.table),this.isActive&&(this.intervalId=setInterval(this.timeLeft,1e3),this.timeLeft())},beforeDestroy:function(){this.intervalId&&clearInterval(this.intervalId,1e3)},computed:{isActive:function(){return"active"===this.data.status}},methods:{timeLeft:function(){var t=this.timeDiff(),e=3e5;this.isSoonOver=t<e,this.timeLeftString=t>0?t.format("HH:mm:ss"):"00:00:00",t<0&&this.isActive&&(this.sendExpired(),clearInterval(this.intervalId,1e3)),this.isSoonOver&&this.willSendNote&&(this.willSendNote=!1,this.$store.dispatch("addNote",{note:this.data}))},timeDiff:function(){var t=this.$moment(),e=this.$moment.tz(this.data.start_time,t.format("z"));return this.$moment(e.diff(t))},sendExpired:function(){this.$store.dispatch("sendExpiredCertificate",{id:this.data.id})},removeCertificate:function(){var t=this;return this.$store.dispatch("removeCertificate",{id:this.data.id}).then((function(){clearInterval(t.intervalId,1e3)}))},toggleTimer:function(){var t=this;this.timer=!1,this.removeCertificate().then((function(){}),(function(){t.timer=!0}))},changeGuest:function(t){var e=this;t.target.open||this.$axios.post("/certificates-edit",{description:this.description,table_number:this.localTable,id:this.data.id}).catch((function(t){console.warn(t),e.description="",e.localTable=""}))}}},Be=ze,Fe=Object(f["a"])(Be,Ye,He,!1,null,null,null),Ue=Fe.exports,Ge=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{ref:"note",staticClass:"note",class:{"note--removed-left":"left"===t.isRemoved,"note--removed-right":"right"===t.isRemoved}},[t.isBank||"scanned"!==t.note._type?t._e():s("div",{staticClass:"note__wrapper"},[s("h4",{staticClass:"note__title",class:{"note__title--error":"error"===t.note.status}},[s("SvgIcon",{attrs:{name:"qr","class-name":"note__message-icon",width:"26",height:"26"}}),t._v(t._s(t.note.message)+" ")],1)]),t.isBank||"scanned"===t.note._type?t._e():s("div",{staticClass:"note__wrapper"},[s("h4",{staticClass:"note__title"},[s("SvgIcon",{attrs:{name:"info","class-name":"note__message-icon",width:"16",height:"16"}}),t._v("Заканчивается время пребывания в Бизнес-зале "),s("span",{staticClass:"note__time-left"},[t._v("Осталось: 5 мин")])],1),s("p",{staticClass:"note__text"},[t._v(" Гость №"+t._s(t.note.queue_id?t.note.queue_id:"")+" "+t._s(t.note.user_name?t.note.user_name:"")+" "),s("span",{staticClass:"note__info"},[t._v(t._s(t.note.description?t.note.description:""))])])]),t.isBank?s("div",{staticClass:"note__wrapper note__wrapper--bank"},[t._m(0),s("h4",{staticClass:"note__title"},[s("span",[t._v("Тинькофф банк ")]),"failed"===t.note.status?s("span",{staticClass:"note__message note__message--error"},[t._v("Ошибка оплаты")]):t._e(),"OrderCreatedEvent"===t.note._type?s("span",{staticClass:"note__message"},[t._v("QR-код cформирован")]):t._e(),"completed"===t.note.status?s("span",{staticClass:"note__message note__message--success"},[t._v("Оплата успешна")]):t._e(),"processing"===t.note.status?s("span",{staticClass:"note__message"},[t._v("Оплата обрабатывается")]):t._e(),t.note.info?s("span",{staticClass:"note__info"},[t._v(t._s(t.note.info))]):t._e()])]):t._e()])},Ve=[function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"note__img-wrapper"},[s("img",{attrs:{src:"/img/bank-logo.png",alt:"",width:"32",height:"32"}})])}],Je={props:{note:{type:Object,default:function(){return{type:"end"}}}},data:function(){return{xBase:0,currentStart:0,currentDiff:0,xDiff:0,isRemoved:!1}},mounted:function(){var t=this;this.xBase=this.$refs.note.getBoundingClientRect().x,this.$refs.note.addEventListener("touchstart",this.handleStartTouch),this.$refs.note.addEventListener("touchend",this.handleStopTouch),setTimeout((function(){t.removeNewNote(!1,!1)}),1e4)},computed:{isBank:function(){return"OrderUpdatedEvent"===this.note._type||"OrderCreatedEvent"===this.note._type}},methods:{removeNewNote:function(t){var e=this,s=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];this.isRemoved=t?"right":"left",s&&setTimeout((function(){e.$store.commit("removeNewNote",{note:e.note})}),100)},handleStopTouch:function(){this.$refs.note.removeEventListener("touchmove",this.handleTouch),this.isRemoved||(this.$refs.note.style.transform="translateX(0)")},handleTouch:function(t){var e=t.target.closest(".note"),s=e.offsetWidth/2;this.currentStart=t.touches[0].clientX-this.curretnDiff;var a=this.currentStart-this.xBase>s,i=-(this.currentStart-this.xBase)>s;if(a||i)return this.removeNewNote(a),void(e.style.transform="translateX(".concat(this.currentStart-this.xBase>0?s:-s,"px)"));e.style.transform="translateX(".concat(this.currentStart-this.xBase,"px)")},handleStartTouch:function(t){this.$refs.note.addEventListener("touchmove",this.handleTouch),this.currentStart=t.touches[0].clientX,this.curretnDiff=this.currentStart-this.xBase}}},Qe=Je,Xe=Object(f["a"])(Qe,Ge,Ve,!1,null,null,null),Ke=Xe.exports,We=s("7f45"),Ze=s.n(We),ts=s("404b"),es=s.n(ts),ss=s("9ce7"),as=s.n(ss),is=s("782e"),rs=s.n(is),ns=s("bd8c"),os=s.n(ns),cs=function(){return window.location.protocol+"//"+window.location.hostname};a["default"].use(os.a),window.Pusher=rs.a,a["default"].use(as.a,{broadcaster:"pusher",key:"bee10ad037be8404d746",cluster:"eu",forceTLS:!0,authEndpoint:cs()+"/broadcasting/auth",auth:{headers:{Authorization:rt.getters["token"]}}}),a["default"].config.productionTip=!1,a["default"].config.devtools=!0,V.a.defaults.withCredentials=!0,V.a.defaults.baseURL=cs()+"/api"||!1,V.a.defaults.headers.common["Access-Control-Allow-Origin"]="*",V.a.defaults.headers.common["Access-Control-Allow-Credentials"]="true",V.a.defaults.headers.common["authorization"]=rt.getters["token"],a["default"].prototype.$axios=V.a,a["default"].prototype.$eventBus=new a["default"],a["default"].prototype.$moment=Ze.a,a["default"].prototype.$moment.tz.setDefault("Etc/GMT+0"),a["default"].component("SvgIcon",Ee),a["default"].component("TimerToggler",kt),a["default"].component("Timer",Me),a["default"].component("Guest",Ue),a["default"].component("Note",Ke),a["default"].component("DatePicker",es.a),new a["default"]({router:$e,store:rt,render:function(t){return t(Y)}}).$mount("#app")},b72f:function(t,e,s){},ca2e:function(t,e,s){},d9ba:function(t,e,s){}});
//# sourceMappingURL=app.js.map